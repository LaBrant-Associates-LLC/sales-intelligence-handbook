{% extends "base.html" %}

{% block content %}
<div id="password-overlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%); z-index: 9999; display: flex; align-items: center; justify-content: center;">
  <div style="text-align: center; max-width: 380px; padding: 20px;">
    <!-- Blue L Logo Circle -->
    <div style="width: 80px; height: 80px; background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%); border-radius: 50%; margin: 0 auto 25px; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 20px rgba(21, 101, 192, 0.4);">
      <span style="color: white; font-size: 42px; font-weight: 700; font-family: 'Georgia', serif;">L</span>
    </div>

    <!-- Title -->
    <h1 style="color: white; font-size: 24px; font-weight: 600; margin: 0 0 8px 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">LaBrant Sales Intelligence</h1>

    <!-- Subtitle -->
    <p style="color: #8892b0; font-size: 14px; margin: 0 0 35px 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;">SE Wisconsin Commercial Painting</p>

    <!-- Password Form -->
    <form id="password-form">
      <input type="password" id="password-input" placeholder="Enter password"
        style="width: 100%; padding: 14px 18px; font-size: 16px; background: rgba(255,255,255,0.08); border: 1px solid rgba(255,255,255,0.15); border-radius: 6px; box-sizing: border-box; margin-bottom: 16px; color: white; outline: none; transition: border-color 0.2s;"
        onfocus="this.style.borderColor='#1565c0'" onblur="this.style.borderColor='rgba(255,255,255,0.15)'"
        autocomplete="off">
      <button type="submit"
        style="width: 100%; padding: 14px; font-size: 16px; font-weight: 600; background: linear-gradient(135deg, #1565c0 0%, #0d47a1 100%); color: white; border: none; border-radius: 6px; cursor: pointer; transition: transform 0.2s, box-shadow 0.2s;"
        onmouseover="this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 15px rgba(21, 101, 192, 0.4)'"
        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='none'">
        Access Portal
      </button>
      <p id="error-msg" style="color: #ef5350; margin-top: 18px; font-size: 14px; display: none;">Incorrect password</p>
    </form>
  </div>
</div>

<div id="main-content" style="display: none;">
  {{ super() }}
</div>

<script>
(function() {
  const SESSION_KEY = 'labrant_handbook_auth';
  const PASSWORD = 'icefish';

  function checkAuth() {
    return sessionStorage.getItem(SESSION_KEY) === 'true';
  }

  function showContent() {
    document.getElementById('password-overlay').style.display = 'none';
    document.getElementById('main-content').style.display = 'block';
  }

  function showLogin() {
    document.getElementById('password-overlay').style.display = 'flex';
    document.getElementById('main-content').style.display = 'none';
  }

  // Check if already authenticated
  if (checkAuth()) {
    showContent();
  } else {
    showLogin();
  }

  // Handle form submission
  document.getElementById('password-form').addEventListener('submit', function(e) {
    e.preventDefault();
    const input = document.getElementById('password-input').value;

    if (input === PASSWORD) {
      sessionStorage.setItem(SESSION_KEY, 'true');
      showContent();
    } else {
      document.getElementById('error-msg').style.display = 'block';
      document.getElementById('password-input').value = '';
      document.getElementById('password-input').focus();
    }
  });
})();
</script>
{% endblock %}
