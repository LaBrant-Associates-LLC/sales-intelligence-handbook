{% extends "base.html" %}

{% block extrahead %}
<script>
(function() {
  var savedScroll = 0;

  // Block ALL scroll methods for sidebar
  ['scrollIntoView', 'scrollTo', 'scroll', 'scrollBy'].forEach(function(method) {
    var orig = Element.prototype[method];
    if (orig) {
      Element.prototype[method] = function() {
        if (this.closest && this.closest('.md-sidebar--primary')) return;
        return orig.apply(this, arguments);
      };
    }
  });

  // Save position on mousedown (before click completes)
  document.addEventListener('mousedown', function() {
    var wrap = document.querySelector('.md-sidebar--primary .md-sidebar__scrollwrap');
    if (wrap) savedScroll = wrap.scrollTop;
  }, true);

  // Aggressively restore
  function restore() {
    var wrap = document.querySelector('.md-sidebar--primary .md-sidebar__scrollwrap');
    if (wrap && savedScroll !== undefined) {
      wrap.scrollTop = savedScroll;
    }
  }

  // Hammer it
  setInterval(restore, 10);
})();
</script>
{% endblock %}
